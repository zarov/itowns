<html>
    <head>
        <title>Itowns - Entwine planar</title>

        <meta charset="UTF-8">
        <link rel="stylesheet" type="text/css" href="css/example.css">
        <link rel="stylesheet" type="text/css" href="css/LoadingScreen.css">

        <style type="text/css">
            #info {
                color: #7ad7ff;
                font-family: 'Open Sans', sans-serif;
                position: absolute;
                top: 0;
                left: 0;
                padding: 0.3rem;
                background-color: #404040;
                z-index: 1;
            }
            @media (max-width: 600px) {
                #info,
                .dg {
                    display: none;
                }
            }
        </style>

        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.6/dat.gui.min.js"></script>
    </head>
    <body>
        <div id="viewerDiv">
            <div id="info"></div>
        </div>

        <script src="../dist/itowns.js"></script>
        <script src="js/GUI/LoadingScreen.js"></script>
        <script src="../dist/debug.js"></script>
        <script type="text/javascript">
            itowns.proj4.defs("EPSG:2154","+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs");

            // Define geographic extent: CRS, min/max X, min/max Y
            var extent = new itowns.Extent(
     //       'EPSG:3857', -20037508, 20037508, -20037508, 20037508);
            'EPSG:2154', -378305.81, 1212610.74, 6093283.21, 7186901.68);
            //'EPSG:2154', 593915.709775816, 810385.373879435, 6069864.416125850,
           //     6199807.364210649);

            // `viewerDiv` will contain iTowns' rendering area (`<canvas>`)
            var viewerDiv = document.getElementById('viewerDiv');

            // Instanciate PlanarView
            // By default itowns' tiles geometry have a "skirt" (ie they have a height),
            // but in case of orthographic we don't need this feature, so disable it
            var view = new itowns.PlanarView(viewerDiv, extent, {
                disableSkirt: true,
                maxSubdivisionLevel: 20,
            });
            var controls = new itowns.PlanarControls(view, {
                maxAltitude: 4000000,
                zoomInFactor: 0.5,
                zoomOutFactor: 0.5,
            });

            var debugGui = new dat.GUI();

            // TODO ajouter meurthe et moselle
            var vosgesSource = new itowns.WMSSource({
                url: 'http://rpg-qualif13.ign.fr/wxs',
                name: 'DEP88_2018',
                extent: extent,
                projection: 'EPSG:2154',
                version: '1.3.0',
                format: 'image/png',
            });

            var vosgesLayer = new itowns.ColorLayer('Vosges', {
                source: vosgesSource,
            });

            view.addLayer(vosgesLayer);

            // EPT source
            var eptSource = new itowns.EntwinePointTileSource({
                // EPT folder to set here
                url: 'http://localhost/data-itowns/ES19AGL'
                //url: 'http://172.20.1.6/ES19AGL',
                // networkOptions: { mode: 'no-cors' }
            });

            // EPT layer
            var eptLayer = new itowns.EntwinePointTileLayer('ES19AGL', {
                source: eptSource
            }, view);

            eptLayer.whenReady.then(() => {
                debug.PotreeDebug.initTools(view, eptLayer, debugGui);
            });

            itowns.View.prototype.addLayer.call(view, eptLayer);
        </script>
    </body>
</html>
